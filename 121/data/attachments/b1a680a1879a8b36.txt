var jsonData = pm.response.json();

pm.test("Response status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Kid Goal Id", function () {
    pm.collectionVariables.set("kidGoalId", jsonData[0].id);  
});

pm.test("Response is an array of objects", function () {
    pm.expect(pm.response.json()).to.be.an('array').that.is.not.empty;
    pm.response.json().forEach(function(goal) {
        pm.expect(goal).to.be.an('object');
    });
});

pm.test("Each goal object has specific properties", function () {
    pm.response.json().forEach(function(goal) {
        pm.expect(goal).to.have.property('id');
        pm.expect(goal).to.have.property('parent_email');
        pm.expect(goal).to.have.property('kid_account');
        pm.expect(goal).to.have.property('target_amount');
        pm.expect(goal).to.have.property('title');
        pm.expect(goal).to.have.property('automation');
        pm.expect(goal).to.have.property('created_at');
        pm.expect(goal).to.have.property('modified_at');
    });
});
