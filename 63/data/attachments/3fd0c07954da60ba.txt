
pm.test("Response status code is 400", function () {
  pm.expect(pm.response.code).to.equal(400);
});


pm.test("Validate that the 'non_field_errors' array is present and not empty", function () {
  const responseData = pm.response.json();
  
  pm.expect(responseData).to.be.an('object');
  pm.expect(responseData.non_field_errors).to.exist.and.to.be.an('array').and.to.have.lengthOf.at.least(1, "Array should not be empty");
});

pm.test("Verify that the response does not contain any other fields", function () {
  const responseData = pm.response.json();
  
  pm.expect(responseData).to.be.an('object');
  pm.expect(Object.keys(responseData)).to.have.lengthOf(1, "Response should only contain 'non_field_errors' field");
  pm.expect(responseData.non_field_errors).to.be.an('array').and.to.have.lengthOf(1, "non_field_errors should be an array with one element");
});

pm.test("Verify that the error message exist", function () {
    pm.expect(pm.response.json().non_field_errors).to.exist;
    pm.expect(pm.response.json().non_field_errors).to.equal("Unable to log in with provided credentials.")
});


